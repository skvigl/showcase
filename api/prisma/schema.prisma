generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mysql"
}

model events {
  id         Int       @id @default(autoincrement())
  name       String    @db.VarChar(64)
  start_date DateTime  @db.DateTime(0)
  end_date   DateTime  @db.DateTime(0)
  deleted_at DateTime? @db.DateTime(0)
  matches    matches[]
}

model matches {
  id                                Int            @id @default(autoincrement())
  event_id                          Int
  date                              DateTime       @db.DateTime(0)
  status                            matches_status @default(scheduled)
  home_team_id                      Int
  away_team_id                      Int
  home_team_score                   Int            @default(0)
  away_team_score                   Int            @default(0)
  deleted_at                        DateTime?      @db.DateTime(0)
  events                            events         @relation(fields: [event_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "matches_ibfk_1")
  teams_matches_home_team_idToteams teams          @relation("matches_home_team_idToteams", fields: [home_team_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "matches_ibfk_2")
  teams_matches_away_team_idToteams teams          @relation("matches_away_team_idToteams", fields: [away_team_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "matches_ibfk_3")

  @@index([away_team_id], map: "away_team_id")
  @@index([event_id], map: "event_id")
  @@index([home_team_id], map: "home_team_id")
}

model players {
  id         Int       @id @default(autoincrement())
  team_id    Int?
  first_name String    @db.VarChar(64)
  last_name  String    @db.VarChar(64)
  power      Int
  deleted_at DateTime? @db.DateTime(0)
  teams      teams?    @relation(fields: [team_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "players_ibfk_1")

  @@index([team_id], map: "team_id")
}

model teams {
  id                                  Int       @id @default(autoincrement())
  name                                String    @db.VarChar(64)
  deleted_at                          DateTime? @db.DateTime(0)
  matches_matches_home_team_idToteams matches[] @relation("matches_home_team_idToteams")
  matches_matches_away_team_idToteams matches[] @relation("matches_away_team_idToteams")
  players                             players[]
}

model User {
  id            Int            @id @default(autoincrement())
  email         String         @unique(map: "email") @db.VarChar(64)
  password      String         @db.VarChar(64)
  role          users_role     @default(user)
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  deletedAt     DateTime?
  refreshTokens RefreshToken[]

  @@map("users")
}

model RefreshToken {
  id        Int      @id @default(autoincrement())
  token     String   @unique @db.VarChar(64)
  userId    Int
  expiresAt DateTime
  createdAt DateTime @default(now())

  user User @relation(fields: [userId], references: [id], onDelete: Cascade, map: "RefreshTokenUser")

  @@index([userId])
  @@map("refresh_tokens")
}

enum users_role {
  user
  admin
  creator
}

enum matches_status {
  scheduled
  live
  finished
}
